\documentclass{article}
\usepackage[utf8x]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{mflogo}
\usepackage{listings}

\lstdefinelanguage[guile]{Scheme}
        {morekeywords={define,let,map,lambda,if,cond,or,and,else},
         morecomment=[l]{;},
         morestring=[b]{"}}
\lstset{mathescape=true}
\lstset{language=[guile]Scheme}
%\lstset{numbers=left,stepnumber=10,numberblanklines=false}
\lstset{basicstyle=\footnotesize}
\lstset{frame=tb,frameround=ffff}
\lstset{breaklines=true,breakautoindent=true}

\newcommand{\filename}[1]{\texttt{#1}}
\newcommand{\procname}[1]{\texttt{#1}}

\usepackage{amsmath,amssymb}

\usepackage{graphics}

\DeclareGraphicsExtensions{.mps,.pdf,.eps}

\numberwithin{equation}{section}

\begin{document}

\author{Дмитрий Джус}
\title{Курсовая работа по теме\\ «Обыкновенные дифференциальные уравнения»}
\maketitle

\newpage

\tableofcontents

\newpage
\part{Постановка задачи}

\section{Математический аспект}

Настоящая курсовая работа посвящена построению приближённого решения
краевой задачи для дифференциального уравнения вида

\begin{equation}\label{deq}
  \frac{d^2 u}{dx^2} + n(x) u = 0
\end{equation}

По условию, $n(x)$ представляет собой кусочно-непрерывную функцию,
равную константе $k^2$ на интервалах $(-\infty; 0)$ и $(a; +\infty)$ и
непрерывной известной функции на $[0; a]$. На границах $[0; a]$
решение и его первая производная должны удовлетворять условиям
сшивания:

\begin{subequations}\label{conds}
  \begin{align}
    u(0-0)& = u(0+0)&
    u(a-0)& = u(a+0)& \\
    u'(0-0)& = u'(0+0)&
    u'(a-0)& = u'(a+0)&
  \end{align}
\end{subequations}

\section{Физический аспект}

Задача соответствует возбуждения плоского слоя неоднородной
немагнитной среды электромагнитным полем, вектор электрического поля
распространяется вдоль оси $x$. $k$ имеет смысл волнового числа в
однородной части пространства, $n(x)$ — показатель преломления
неоднородной среды.

Из физических соображений, решение справа от слоя $[0; a]$ должно
иметь вид $u(x) = Be^{ikx}$, а слева — $u(x) = e^{ikx} +
Ae^{-ikx}$. Задача состоит в приближённом построении решения внутри
неоднородного слоя и отыскании комплексных констант $A$ и $B$
(называемых, соответственно, коэффициентами отражения и прохождения
электромагнитного поля).

Действительная область значений функции $n(x)$ соответствует
отсутствию поглощения энергии в среде, так что критерием правильности
полученных приближённых значений служит энергетическое тождество:

\begin{equation}\label{energy}
  |A|^2 + |B|^2 = 1
\end{equation}

\newpage
\part{Решение}

\section{Общие замечания}

Предлагаемые к реализации в курсовой работае приближённые методы были
описаны на алгоритмическом языке Scheme (простом и строго
функциональном диалекте Лиспа).

\section{Решение методом построения фундаментальной матрицы}

\subsection{Описание}

Дифференциальное уравнение второго порядка \eqref{deq} можно представить
в матричной форме, введя $v(x) = \frac{du}{dx}$:

\begin{equation}\label{mdeq}
  \frac{d}{dx}
  \begin{pmatrix}
    u(x) \\
    v(x)
  \end{pmatrix}
  = \begin{pmatrix}
    0 & 1 \\
    -n(x) & 0
  \end{pmatrix}
  \begin{pmatrix}
    u(x) \\
    v(x)
  \end{pmatrix}
\end{equation}

Решение системы \eqref{mdeq} с матрицей $A(x) = \bigl( \begin{smallmatrix} 0
  & 1 \\ -n(x) & 0 \end{smallmatrix} \bigr)$ можно найти в общем виде, если
построена фундаментальная матрица $\Omega(x)$:

\begin{equation}\label{fm}
\Omega(x) = \begin{pmatrix}
  \omega_{11}(x) & \omega_{12}(x) \\
  \omega_{21}(x) & \omega_{22}(x)
\end{pmatrix}
\end{equation}

$\Omega(x)$ является решением следующей матричной задачи Коши:

\begin{equation}\label{fmeq}
  \frac{d}{dx} \Omega(x) = A(x) \Omega(x)
\end{equation}

с условием $\Omega(0) = \bigl( \begin{smallmatrix} 1& 0\\ 0&
  1\end{smallmatrix} \bigr)$.

Решение \eqref{mdeq} для $\forall x \in [0; a]$ записывается в виде

\begin{equation}\label{fmsolution}
\begin{pmatrix}
  u(x) \\
  v(x)
\end{pmatrix} = 
\begin{pmatrix}
  \omega_{11}(x) & \omega_{12}(x) \\
  \omega_{21}(x) & \omega_{22}(x)
\end{pmatrix}
\begin{pmatrix}
  1 + A \\
  ik(1 - A)
\end{pmatrix}
\end{equation}

Использование краевых условий \eqref{conds} позволяет получить
следующую линейную алгебраическую систему относительно неизвестных $A$
и $B$:

\begin{equation}\label{abeq}
  \begin{split}
    (\omega_{11}(a) - \omega_{12}(a) ik) A - e^{ika} B &= -ik
    \omega_{12}(a) - \omega_{11}(a) \\
    (\omega_{21}(a) - \omega_{22}(a) ik) A - ike^{ika} B &= -ik
    \omega_{22}(a) - \omega_{21}(a)
  \end{split}
\end{equation}

Нахождение значений компонентов матрицы $\Omega$ на правом конце $[0;
a]$, таким образом, позволит получить искомые значения $A$ и $B$.

Для поиска фундаментальной матрицы в точках $[0; a]$ предлагается
использование следующего численного метода, основанного на приближении
функции $n(x)$ кусочно-постоянной, то есть замене неоднородной среды
на плоско-слоистую с большим числом однородных слоёв.

Рассматриваемый интервал разбивается на $N$ интервалов точками
$x_i = \frac{a}{N}i$, $i = 1 \ldots N$, в середине каждого из
которых берётся точка $\overline{x_i} = \frac{a}{N}(i+\frac{i}{2})$. В
данной точке функция $n(x)$ аппроксимируется ступенчатой функцией
$\overline{n}(x) = n(\overline{x_i})$, так что \eqref{mdeq} обращается
в систему с постоянной матрицей $A_i = \bigl(
\begin{smallmatrix}0& 1 \\ -\overline{n}(x)& 0 \end{smallmatrix}
\bigr)$. Тогда на каждом интервале $[x_i; x_{i+1}]$ решение
\eqref{fmeq} может быть найдено явно в виде матричной экпоненты:

\[
\Omega_i(x) = e^{A_i (x - x_i)}
\]

При этом, значения фундаментальной матрицы $\Omega_N(x_{i+1})$ на
правом конце $[x_i; x_{i+1}]$ служат начальным условием задачи Коши на
$[x_{i+1}; x_{i+2}]$, так что для каждой точки $\hat{x} \in [x_i;
x_{i+1}]$ фундаментальная матрица \eqref{fm} имеет вид:

\begin{equation}\label{fmx}
  \Omega_N(\hat{x}) = e^{A_i(\hat{x}-x_i)} e^{A_{i-1}(x_i-x_{i-1})} \ldots e^{A_0(x_1-x_0)}
\end{equation}

На правом конце интервала $[0; a]$ приближённая фундаментальная
матрица записывается в виде:

\begin{equation}\label{fma}
  \Omega_N(a) = e^{A_{N-1}(x_N-x_{N-1})} e^{A_{N-2}(x_{N-1}-x_{N-2})} \ldots e^{A_0(x_1-x_0)}
\end{equation}

Для нахождения матричной экспоненты используется формула Тейлора:

\begin{equation}\label{matrix-exp}
\begin{split}
  e^{A_i(x-x_i)} \approx E +& \frac{1}{1!}{A_i(x-x_i)} +
  \frac{1}{2!}{A_i^2(x-x_i)^2}\\
  +& \frac{1}{3!}{A_i^3(x-x_i)^3} + \frac{1}{4!}{A_i^4(x-x_i)^4}
\end{split}
\end{equation}

После построения фундаментальной матрицы в $a$ коэффициенты $A$ и $B$
находятся из \eqref{abeq} с использованием полученных компонент
$\omega_{ij}^N(a)$.

Решение на каждом отрезке разбиения $[0; a]$ находится из
\eqref{fmsolution} с использование найденного $A$ и последовательности
приближений фундаментальной матрицы на $[x_i; x_{i+1}]$ для $\forall
i$.

\newpage
\subsection{Реализация}

Описание основных процедур, необходимых для реализации метода,
находится в файле \filename{fundmatrix.scm} (его полное содержание
приведено на странице \pageref{fundmatrix.scm-full-listing}).

В исходном тексте программы активно используются последовательные
определения функций в терминах друг друга.

Так, основной вычислительный процесс метода — построение приближений
фундаментальной матрицы — выражен в функции
\procname{build-fundamentals}:

\input{build-fundamentals__fundmatrix.scm-tag-listing}

\procname{build-fundamentals} представляет последовательность вычислений
фундаментальной матрицы на интервалах $[x_i; x_{i+1}]$ в виде частного
случая функции \procname{evolve-sequence}, возвращающей
последовательность $a_{s_1} \ldots a_{s_n}$, где $a_{s_k} =
f(a_{s_{k-1}}, s_{k-1})$
(см. с. \pageref{shared.scm-full-listing}). Из определения
\procname{build-fundamentals} видно, что роль $s_k$ выполняют точки $x_i
= \frac{a}{N}i$ с $i = 1 \ldots N$, а $a_{s_{k-1}}$ — приближение
фундаментальной матрицы на предыдущем отрезке (на первом шаге
$\Omega_N$ приближается единичной матрицей). Комбинируются же эти
значения при помощи матричного умножения, как следует из \eqref{fmx}.

Функция \procname{variable-matrix} возвращает матрицу $A$ системы
\eqref{mdeq} для заданной по условию функции $n(x)$:

\input{variable-matrix__fundmatrix.scm-tag-listing}

Возвращённая матрица потом используется в \procname{build-fundamentals}.

В \procname{build-fundamentals} используется и функция
\procname{matrix-exp} (см. файл \filename{matrices.scm} на
с. \pageref{matrices.scm-full-listing}), вычисляющая матричную
экспоненту $f(x, y, z) = e^{A(x)(y-z)}$ путём разложения в ряд Тейлора
\eqref{matrix-exp} с использованием схемы Горнера:

\input{matrix-exp__matrices.scm-tag-listing}

В этой функции последовательность коэффициентов матричного многочлена
$\frac{1}{0!}, \frac{1}{1!}, \frac{1}{2!} \ldots$ генерируется
функцией \procname{exp-series-coefficients}
(см. с. \pageref{shared.scm-full-listing}), выраженной в терминах
вышеупомянутой \procname{evolve-sequence}.

Вычисление матричной экспоненты в каждой точке выражено через
функцию высшего порядка \procname{general-horner-eval}, представляющую
собой обобщённую схему Горнера:

\input{general-horner-eval__shared.scm-tag-listing}

\procname{general-horner-eval}, в свою очередь, является частным случаем
функции высшего порядка \procname{fold-right}, реализующей свёртку
последовательности справа налево.

После построения последовательности фундаментальных матриц
осуществляется поиск коэффициентов $A, B$ путём решения системы
\eqref{abeq} с помощью метода Гаусса (его исходный код приведён на
странице \pageref{gauss.scm-full-listing}):

\input{find-A-B__fundmatrix.scm-tag-listing}

С использованием найденного коэффициента $A$ и приближений из
\procname{build-fundamentals} в функции
\procname{approximate-solution} согласно \eqref{fmsolution}
расчитывается и приближённое решение исходного уравнения \eqref{deq}
внутри неоднородного слоя:

\input{approximate-solution__fundmatrix.scm-tag-listing}

При расчёте найденные значения $A$ и $B$ проверяется на удовлетворение
тождеству \eqref{energy} предикатом \procname{energy-conserves?} из
\filename{shared.scm}:

\input{energy-conserves?__shared.scm-tag-listing}

\newpage
\subsection{Исходные данные}
\label{sec:initial}

\input{initial-data}

\subsection{Результаты}

\input{fm-results}

\newpage
\section{Решение методом последовательных приближений}

\subsection{Описание}

\newpage
\subsection{Реализация}

\newpage
\subsection{Результаты}

Исходные данные к задаче приведены в разделе \ref{sec:initial} на
странице \pageref{sec:initial}.

\newpage
\section{Сопоставление результатов}

\newpage
\appendix
\part{Исходные тексты}
\section{Общие файлы}
\input{shared.scm-full-listing}
\input{matrices.scm-full-listing}
\input{gauss.scm-full-listing}

\newpage
\section{Метод построения  фундаментальной матрицы}

\input{fundmatrix.scm-full-listing}

\newpage
\section{Метод последовательных приближений}

\newpage
\section{Диспетчер}

\input{dispatcher.scm-full-listing}

\newpage
\part{Информация о документе}

Данный документ был подготовлен с использованием \LaTeX{}.

Для автоматизации сборки отчёта о курсовой работе применялась
сборочная система \texttt{GNU Make}. Для извлечения определений
процедур из исходного кода использовались сценарии командной оболочки
и \texttt{GNU Emacs}. С их же помощью был автоматизирован процесс
включения результата расчётов в курсовую работу. Графики решений были
построены по данным, предоставленным расчётной программой, при помощи
средств \MP.

Для автоматического определения зависимостей
\LaTeX{}-файла использовалась утилита \texttt{texdepend}.

\end{document}